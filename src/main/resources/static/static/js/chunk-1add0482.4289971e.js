(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1add0482"],{"1f7d":function(e,t,l){},b775:function(e,t,l){"use strict";var o=l("bc3a"),a=l.n(o),i=a.a.create({baseURL:"http://120.92.114.123:8089",timeout:5e3});i.interceptors.request.use(function(e){return e},function(e){return console.log(e),Promise.reject()}),i.interceptors.response.use(function(e){if(200===e.status)return e.data;Promise.reject()},function(e){return console.log(e),Promise.reject()}),t["a"]=i},ba5b:function(e,t,l){"use strict";l.r(t);var o=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"table"},[l("div",{staticClass:"crumbs"},[l("el-breadcrumb",{attrs:{separator:"/"}},[l("el-breadcrumb-item",[l("i",{staticClass:"el-icon-lx-favor"}),e._v(" 设备管理")])],1)],1),l("div",{staticClass:"container"},[l("div",{staticClass:"handle-box"},[l("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAll}},[e._v("批量作废")]),l("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"型号"},on:{change:function(t){return e.selectModel()}},model:{value:e.select_model,callback:function(t){e.select_model=t},expression:"select_model"}},e._l(e.modelData,function(e){return l("el-option",{key:e,attrs:{label:e,value:e}})}),1),l("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"序列号"},model:{value:e.select_word,callback:function(t){e.select_word=t},expression:"select_word"}}),l("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")])],1),l("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.data,border:""},on:{"selection-change":e.handleSelectionChange}},[l("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),l("el-table-column",{attrs:{prop:"id",label:"ID",width:"50"}}),l("el-table-column",{attrs:{prop:"uuid",label:"UUID",width:"150"}}),l("el-table-column",{attrs:{prop:"mac",label:"MAC",width:"150"}}),l("el-table-column",{attrs:{prop:"sn",label:"序列号",width:"100"}}),l("el-table-column",{attrs:{prop:"model",label:"型号",width:"100"}}),l("el-table-column",{attrs:{prop:"hwVersion",label:"硬件版本",width:"75"}}),l("el-table-column",{attrs:{prop:"fwVersion",label:"固件版本",width:"75"}}),l("el-table-column",{attrs:{prop:"manufacturer",label:"厂商"}}),l("el-table-column",{attrs:{prop:"token",label:"Torken",width:"100"}}),l("el-table-column",{attrs:{prop:"userName",label:"生产者",width:"80"}}),l("el-table-column",{attrs:{prop:"createTime",label:"时间",width:"120"}}),l("el-table-column",{key:e.i,attrs:{label:"操作",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(l){return e.handleDelete(t.row)}}},[e._v("作废")])]}}])})],1),l("div",{staticClass:"pagination"},[l("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":e.page_size,total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1),l("el-dialog",{attrs:{title:"编辑",visible:e.editVisible,width:"30%"},on:{"update:visible":function(t){e.editVisible=t}}},[l("el-form",{ref:"edit_mauf_form",attrs:{rules:e.edit_rules,model:e.form,"label-width":"50px"}},[l("el-form-item",{attrs:{"label-width":"20%",label:"厂商名称",prop:"name"}},[l("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),l("el-form-item",{attrs:{"label-width":"20%",label:"地址",prop:"address"}},[l("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1)],1),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveEdit()}}},[e._v("确 定")])],1)],1),l("el-dialog",{attrs:{title:"修改密码",visible:e.modifyPwdVisible,width:"30%"},on:{"update:visible":function(t){e.modifyPwdVisible=t}}},[l("el-form",{ref:"modify_pwd_form",attrs:{rules:e.modify_pwd_rules,model:e.modify_pwd_form,"label-width":"50px"}},[l("el-form-item",{attrs:{"label-width":"20%",label:"旧密码",prop:"old_pwd"}},[l("el-input",{attrs:{type:"password"},model:{value:e.modify_pwd_form.old_pwd,callback:function(t){e.$set(e.modify_pwd_form,"old_pwd",t)},expression:"modify_pwd_form.old_pwd"}})],1),l("el-form-item",{attrs:{"label-width":"20%",label:"新密码",prop:"new_pwd"}},[l("el-input",{attrs:{type:"password"},model:{value:e.modify_pwd_form.new_pwd,callback:function(t){e.$set(e.modify_pwd_form,"new_pwd",t)},expression:"modify_pwd_form.new_pwd"}})],1),l("el-form-item",{attrs:{"label-width":"20%",label:"确认密码",prop:"confirm_pwd"}},[l("el-input",{attrs:{type:"password"},model:{value:e.modify_pwd_form.confirm_pwd,callback:function(t){e.$set(e.modify_pwd_form,"confirm_pwd",t)},expression:"modify_pwd_form.confirm_pwd"}})],1)],1),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.modifyPwdVisible=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:e.savePwd}},[e._v("确 定")])],1)],1),l("el-dialog",{attrs:{title:"添加厂商",visible:e.addVisible,width:"30%"},on:{"update:visible":function(t){e.addVisible=t}}},[l("el-form",{ref:"add_manuf_form",attrs:{rules:e.add_rules,model:e.form,"label-width":"50px"}},[l("el-form-item",{attrs:{"label-width":"20%",label:"厂商名称",prop:"name"}},[l("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),l("el-form-item",{attrs:{"label-width":"20%",label:"地址",prop:"address"}},[l("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),l("el-form-item",{attrs:{"label-width":"20%",label:"密码",prop:"password"}},[l("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),l("el-form-item",{attrs:{"label-width":"20%",label:"确认密码",prop:"confirmPwd"}},[l("el-input",{attrs:{type:"password"},model:{value:e.form.confirmPwd,callback:function(t){e.$set(e.form,"confirmPwd",t)},expression:"form.confirmPwd"}})],1)],1),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.addVisible=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addManuf()}}},[e._v("确 定")])],1)],1),l("el-dialog",{attrs:{title:"提示",visible:e.deleteRowVisible,width:"300px",center:""},on:{"update:visible":function(t){e.deleteRowVisible=t}}},[l("div",{staticClass:"del-dialog-cnt"},[e._v("作废后将不再使用，是否确定作废？")]),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.deleteRowVisible=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.deleteDevices([e.form])}}},[e._v("确 定")])],1)]),l("el-dialog",{attrs:{title:"提示",visible:e.deleteAllVisible,width:"300px",center:""},on:{"update:visible":function(t){e.deleteAllVisible=t}}},[l("div",{staticClass:"del-dialog-cnt"},[e._v("作废后将不再使用，是否确定作废？")]),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.deleteAllVisible=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.deleteDevices(e.multipleSelection)}}},[e._v("确 定")])],1)])],1)},a=[],i=(l("7f7f"),l("ac6a"),l("b775")),s={modelGroup:function(){return Object(i["a"])({url:"/device/modelGroup",method:"get"})},deviceList:function(e){return Object(i["a"])({url:"/device/listByModel",method:"post",data:e})},deleteDevices:function(e){return Object(i["a"])({url:"/device/deleteDevices",method:"post",data:e})}};l("3b2b"),l("a481");function r(e,t){/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var l={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var o in l)if(new RegExp("(".concat(o,")")).test(t)){var a=l[o]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?a:n(a))}return t}function n(e){return("00"+e).substr(e.length)}var d={name:"manufList",data:function(){var e=this;return{select_model:"",total:0,cur_page:1,page_size:50,select_word:"",tableData:[],modelGroupData:[],addVisible:!1,deleteRowVisible:!1,deleteAllVisible:!1,editVisible:!1,modifyPwdVisible:!1,multipleSelection:[],form:{id:0,name:"",address:"",password:""},modify_pwd_form:{old_pwd:"",new_pwd:"",confirm_pwd:""},add_rules:{name:[{required:!0,message:"请输入厂商名称",trigger:"blur"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],confirmPwd:[{required:!0,message:"请输入确认密码",trigger:"blur"},{validator:function(t,l,o){l!==e.form.password?o(new Error("两次输入密码不一致")):o()},trigger:"blur"}]},edit_rules:{name:[{required:!0,message:"请输入厂商名称",trigger:"blur"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}]},modify_pwd_rules:{old_pwd:[{required:!0,message:"请输入旧密码",trigger:"blur"}],new_pwd:[{required:!0,message:"请输入新密码",trigger:"blur"}],confirm_pwd:[{required:!0,message:"请输入确认密码",trigger:"blur"}]}}},created:function(){this.getModelGroup()},computed:{modelData:function(){return this.modelGroupData},data:function(){var e=this;return this.tableData.filter(function(t){if("number"===typeof t.createTime&&(t.createTime=r(new Date(1e3*t.createTime),"yyyy-MM-dd hh:mm")),t.sn.indexOf(e.select_word)>-1)return t})}},methods:{delAll:function(){this.deleteAllVisible=!0},search:function(){this.getData()},getModelGroup:function(){var e=this;s.modelGroup().then(function(t){"200"===t.code?(e.modelGroupData=t.data.models,e.select_model=e.modelGroupData[0],e.getData()):e.$message.error(t.message)})},getData:function(){var e=this;s.deviceList({model:this.select_model,sn:this.select_word,pageIndex:this.cur_page,pageSize:this.page_size}).then(function(t){"200"===t.code?(e.tableData=t.data.deviceList,e.total=t.data.count):e.$message.error(t.message)})},deleteDevices:function(e){var t=this,l=[];e.forEach(function(e){l.push(e.mac)}),l.forEach(function(e){console.log(e)}),s.deleteDevices({macs:l}).then(function(e){"200"===e.code?(t.deleteRowVisible=!1,t.deleteAllVisible=!1,t.$message.success("作废成功！"),t.getData()):t.$message.error(e.message)})},selectModel:function(){this.getData()},addManuf:function(){var e=this;console.log("read_token:"+localStorage.getItem("ms_token")),this.$refs["add_manuf_form"].validate(function(t){t&&ManufApi.addManuf({name:e.form.name,address:e.form.address,password:e.form.password}).then(function(t){"200"===t.code?(e.addVisible=!1,e.$message.success("添加成功"),e.getData()):e.$message.error(t.message)})})},handleEdit:function(e){this.form={id:e.id,name:e.name,address:e.address},this.editVisible=!0},handleDelete:function(e){this.form=e,this.deleteRowVisible=!0},handleModifyPwd:function(e){this.modify_pwd_form={old_pwd:"",new_pwd:"",confirm_pwd:""},this.form={id:e.id},this.modifyPwdVisible=!0},handleCurrentChange:function(e){this.cur_page=e,this.getData()},handleSelectionChange:function(e){this.multipleSelection=e},showAddManuf:function(){this.form={id:0,name:"",address:"",password:""},this.addVisible=!0},saveEdit:function(){var e=this;console.log("id->"+this.form.id),ManufApi.edit({id:this.form.id,name:this.form.name,address:this.form.address}).then(function(t){"200"===t.code?(e.editVisible=!1,e.$message.success("修改成功"),e.getData()):e.$message.error(t.message)})},savePwd:function(){var e=this;ManufApi.modifyPwd({manufId:this.form.id,oldPwd:this.modify_pwd_form.old_pwd,newPwd:this.modify_pwd_form.new_pwd}).then(function(t){"200"===t.code?(e.modifyPwdVisible=!1,e.$message.success("密码修改成功")):e.$message.error(t.message)})}}},c=d,u=(l("bd5e"),l("2877")),m=Object(u["a"])(c,o,a,!1,null,"40037018",null);t["default"]=m.exports},bd5e:function(e,t,l){"use strict";var o=l("1f7d"),a=l.n(o);a.a}}]);